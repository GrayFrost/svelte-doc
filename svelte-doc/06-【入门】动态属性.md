如果读者接触过Vue或者React，那么必然了解过像Vue的computed、watch和React的useMemo等用于监听某些变量发生更改后才重新计算出新的变量或执行某些方法的Api。

在Svelte中，同样提供了类似的功能。Svelte称之为Reactivity，中文翻译为“反应性”，不过笔者更喜欢称其为响应式能力，触发响应式能力的核心则是——赋值，这个我们在《数据与方法》章节已经简单演示过了。
具体写法如下
```javascript
$: 你的逻辑
```

可能大家会好奇`$`是什么语法，其实它是js正常支持的语法[JS label 语法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/label)，只是少有人用，相当于一个几乎废弃的语法。
  
Svelte通过使用 `$:` 作为前缀，可以让任何位于 top-level 的语句（即不在块或函数内部）具有反应性。每当它们依赖的值发生更改时，它们都会在组件更新之前立即运行。

## 声明

### `$:`语法

如果语句完全由未声明变量的赋值组成，则Svelte替你将 `let`插入声明
```html
<script>
  let count = 0;

  $: double = count * 2;
  
  let noReactiveDouble = count * 2;

  const add = () => {
    count++;
  }

</script>

<button on:click={add}>add</button><br>
count: {count}<br>
doubleCount: {double}<br>
noReactiveDouble: {noReactiveDouble}
```

![[test19.gif]]

我们不用声明`let double`，在`$: double = count * 2;`中相当于Svelte自动帮我们声明了。

## 语句

我们在上述代码中添加一行：
```javascript
$: console.log('$ console', count, double, noReactiveDouble);
```

![[test20.gif]]

### 与beforeUpdate的区别

```html
<script>
  import { beforeUpdate } from 'svelte';

  let count = 0;
  let noReactiveDouble = count * 2;

  const add = () => {
    count++;
  }

  $: console.log('$ console', noReactiveDouble);

  beforeUpdate(() => {
    console.log('beforeUpdate console', noReactiveDouble)
  })

</script>

<button on:click={add}>add</button><br>
count: {count}<br>
noReactiveDouble: {noReactiveDouble}
```

![[test18.gif]]
当我们重新刷新页面时，可以看到`$`里执行了一次，beforeUpdate也执行了一次。因为`let noReactiveDouble = count * 2`是赋值操作，触发了`$: console.log('$ console', noReactiveDouble);`；而beforeUpdate则是由于`count`和`noReactiveDouble`这两个变量有赋值操作。
当我们点击更新时，因为`noReactiveDouble`不是响应性的变量，因此只会触发beforeUpdate。

`$`语句内的逻辑只有在语句内的变量触发更新时才会执行。而beforeUpdate则相当于收集了所有变量依赖。当其中的一个依赖变化时则执行。

### 声明
语句除了能像`$: console.log()`这样单行写，也可以包裹在一个`{}`花括号中。
```javascript
$: {
	// 执行逻辑
}
```
在声明章节，我们知道了Svelte能够帮我们自动声明未使用let声明的变量。然而当我们使用`{}`时，还是需要自己进行声明。

```html
<script>
  let count = 0;
  $: double = count * 2;
  let double2;

  $: {
    double2 = count * 2;
  }

  const add = () => {
    count++;
  }
</script>

<button on:click={add}>add</button><br>
count: {count}<br>
doubleCount: {double}<br>
double2: {double2}
```

![[test21.gif]]

## 小结
当我们在进阶篇讲解store时，会继续遇到`$`，只是那时，又是另一番天地了。